"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("node:path"),r=require("node:url"),n=require("node:worker_threads"),t=require("fs"),o="undefined"!=typeof document?document.currentScript:null;const i="undefined"!=typeof __dirname?__dirname:e.dirname(r.fileURLToPath("undefined"==typeof document?require("url").pathToFileURL(__filename).href:o&&o.src||new URL("index.cjs",document.baseURI).href));exports.default=async function(r,o,s){return new Promise(((d,a)=>{const u=e.join(i,"thread.js"),c=e.join(o,"thread.js"),f=t.readFileSync(u,"utf8");t.writeFileSync(c,f);const l={cb:`(()=>${r.toString()})()`,params:s,rmThreadjsFile:c},m=new n.Worker(c,{workerData:l});m.on("message",(e=>{e.error?a(e.result):d(e.result)})),m.on("error",(e=>{a(e)})),m.on("exit",((e,r)=>{const n={message:`Worker stopped with exit code ${e}`,code:e};a(new Error(JSON.stringify(n)))}))}))},exports.wormiseDafaultDirname=n=>{const t=r.fileURLToPath(n);return e.dirname(t)};