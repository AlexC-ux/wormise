import{dirname as r,join as e}from"node:path";import{fileURLToPath as o}from"node:url";import t from"node:worker_threads";import n from"fs";const s="undefined"!=typeof __dirname?__dirname:r(o(import.meta.url)),i=e=>{const t=o(e);return r(t)};async function a(r,o,i){return new Promise(((a,m)=>{const d=e(s,"thread.js"),c=e(o,"thread.js"),f=n.readFileSync(d,"utf8");n.writeFileSync(c,f);const p={cb:`(()=>${r.toString()})()`,params:i,rmThreadjsFile:c},u=new t.Worker(c,{workerData:p});u.on("message",(r=>{r.error?m(r.result):a(r.result)})),u.on("error",(r=>{m(r)})),u.on("exit",((r,e)=>{const o={message:`Worker stopped with exit code ${r}`,code:r};m(new Error(JSON.stringify(o)))}))}))}export{a as default,i as wormiseDafaultDirname};