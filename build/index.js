"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("node:path"),r=require("node:url"),t=require("node:worker_threads"),n=require("fs"),o="undefined"!=typeof document?document.currentScript:null;const i=r.fileURLToPath("undefined"==typeof document?require("url").pathToFileURL(__filename).href:o&&o.src||new URL("index.js",document.baseURI).href),s=e.dirname(i);exports.default=async function(r,o,i){return new Promise(((a,u)=>{const d=e.join(s,"thread.js"),c=e.join(o,"thread.js"),l=n.readFileSync(d,"utf8");n.writeFileSync(c,l);const f={cb:`(()=>${r.toString()})()`,params:i,rmThreadjsFile:c},m=new t.Worker(c,{workerData:f});m.on("message",(e=>{e.error?u(e.result):a(e.result)})),m.on("error",(e=>{u(e)})),m.on("exit",((e,r)=>{const t={message:`Worker stopped with exit code ${e}`,code:e};u(new Error(JSON.stringify(t)))}))}))},exports.wormiseDafaultDirname=t=>{const n=r.fileURLToPath(t);return e.dirname(n)};