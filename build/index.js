import{dirname as r,join as e}from"node:path";import{fileURLToPath as o}from"node:url";import t from"node:worker_threads";import n from"fs";const s=o(import.meta.url),i=r(s),a=e=>{const t=o(e);return r(t)};async function m(r,o,s){return new Promise(((a,m)=>{const c=e(i,"thread.js"),d=e(o,"thread.js"),p=n.readFileSync(c,"utf8");n.writeFileSync(d,p);const f={cb:`(()=>${r.toString()})()`,params:s,rmThreadjsFile:d},u=new t.Worker(d,{workerData:f});u.on("message",(r=>{r.error?m(r.result):a(r.result)})),u.on("error",(r=>{m(r)})),u.on("exit",((r,e)=>{const o={message:`Worker stopped with exit code ${r}`,code:r};m(new Error(JSON.stringify(o)))}))}))}export{m as default,a as wormiseDafaultDirname};